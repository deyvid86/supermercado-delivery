<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <title>Supermercado Delivery</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 900px;
      margin: auto;
    }
    .search-bar {
      margin-bottom: 20px;
    }
    .product {
      border: 1px solid #ccc;
      padding: 10px;
      display: flex;
      gap: 10px;
      margin-bottom: 10px;
      align-items: center;
    }
    .product img {
      width: 80px;
      height: 80px;
      object-fit: cover;
    }
    .product-info {
      flex: 1;
    }
    .category-title {
      margin-top: 30px;
      font-size: 20px;
      border-bottom: 2px solid #ccc;
      padding-bottom: 5px;
    }
    input, select, button {
      padding: 10px;
      margin-top: 10px;
      width: 100%;
      box-sizing: border-box;
    }
    button {
      background-color: green;
      color: white;
      font-weight: bold;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background-color: darkgreen;
    }
    .remover-btn {
      background-color: red;
      margin-left: 10px;
      padding: 4px 8px;
      font-size: 12px;
    }
    .clear-cart {
      background-color: #555;
      margin-top: 10px;
    }
    .quantidade-btn {
      background-color: #333;
      color: white;
      padding: 4px 8px;
      margin: 0 5px;
      font-size: 14px;
      border: none;
    }
    .cart, .checkout {
      margin-top: 30px;
    }
    #troco-container {
      display: none;
    }
  </style>
</head>
<body>

  <h1>Supermercado Delivery</h1>

  <input type="text" id="search" class="search-bar" placeholder="Buscar produto..." onkeyup="renderizarProdutos()" />

  <div id="product-list"></div>

  <div class="cart">
    <h2>Carrinho</h2>
    <ul id="cart-items"></ul>
    <p><strong>Total: R$ <span id="total">0.00</span></strong></p>
    <button class="clear-cart" onclick="limparCarrinho()">Remover tudo do carrinho</button>
  </div>

  <div class="checkout">
    <h3>Endereço de entrega</h3>
    <input type="text" id="endereco" placeholder="Digite seu endereço completo" />

    <h3>Forma de pagamento</h3>
    <select id="forma-pagamento" onchange="verificarPagamento()">
      <option value="Pix">Pix</option>
      <option value="Cartão">Cartão</option>
      <option value="Dinheiro">Dinheiro</option>
    </select>

    <div id="troco-container">
      <h4>Troco para quanto?</h4>
      <input type="text" id="troco" placeholder="Ex: 100.00" />
    </div>

    <br />
    <button onclick="finalizarPedido()">Finalizar Pedido no WhatsApp</button>
  </div>

  <script>
    const produtos = [
      { nome: "Arroz 5kg", preco: 25, categoria: "Alimentos", imagem: "https://i.imgur.com/abcde123.jpg" },
      { nome: "Feijão 1kg", preco: 7, categoria: "Alimentos", imagem: "https://via.placeholder.com/80?text=Feijao" },
      { nome: "Macarrão", preco: 5, categoria: "Alimentos", imagem: "https://via.placeholder.com/80?text=Macarrao" },
      { nome: "Óleo", preco: 6, categoria: "Alimentos", imagem: "https://via.placeholder.com/80?text=Oleo" },
      { nome: "Detergente", preco: 3, categoria: "Limpeza", imagem: "https://via.placeholder.com/80?text=Detergente" },
      { nome: "Sabão em pó", preco: 10, categoria: "Limpeza", imagem: "https://via.placeholder.com/80?text=Sabao" }
    ];

    const carrinho = [];

    function renderizarProdutos() {
      const lista = document.getElementById("product-list");
      const busca = document.getElementById("search").value.toLowerCase();
      lista.innerHTML = "";

      const categorias = [...new Set(produtos.map(p => p.categoria))];

      categorias.forEach(cat => {
        const categoriaDiv = document.createElement("div");
        const produtosCategoria = produtos.filter(p => p.categoria === cat && p.nome.toLowerCase().includes(busca));

        if (produtosCategoria.length > 0) {
          const titulo = document.createElement("h2");
          titulo.className = "category-title";
          titulo.textContent = cat;
          categoriaDiv.appendChild(titulo);

          produtosCategoria.forEach((produto, index) => {
            const div = document.createElement("div");
            div.className = "product";
            div.innerHTML = `
              <img src="${produto.imagem}" alt="${produto.nome}" />
              <div class="product-info">
                <strong>${produto.nome}</strong><br/>
                Preço: R$ ${produto.preco.toFixed(2)}<br/>
                <input type="number" id="qtd-${produto.nome}" value="1" min="1" />
                <button onclick="adicionarAoCarrinho('${produto.nome}')">Adicionar ao carrinho</button>
              </div>
            `;
            categoriaDiv.appendChild(div);
          });

          lista.appendChild(categoriaDiv);
        }
      });
    }

    function adicionarAoCarrinho(nome) {
      const produto = produtos.find(p => p.nome === nome);
      const qtd = parseInt(document.getElementById(`qtd-${nome}`).value);
      if (qtd < 1) return;

      const existente = carrinho.find(item => item.nome === nome);
      if (existente) {
        existente.quantidade += qtd;
      } else {
        carrinho.push({ ...produto, quantidade: qtd });
      }
      atualizarCarrinho();
    }

    function atualizarCarrinho() {
      const listaCarrinho = document.getElementById("cart-items");
      listaCarrinho.innerHTML = "";
      let total = 0;

      carrinho.forEach((item, index) => {
        const li = document.createElement("li");
        li.innerHTML = `
          ${item.nome} - R$ ${(item.preco * item.quantidade).toFixed(2)}
          <div>
            <button class="quantidade-btn" onclick="alterarQuantidade(${index}, -1)">-</button>
            ${item.quantidade}
            <button class="quantidade-btn" onclick="alterarQuantidade(${index}, 1)">+</button>
            <button class="remover-btn" onclick="removerDoCarrinho(${index})">Remover</button>
          </div>
        `;
        listaCarrinho.appendChild(li);
        total += item.preco * item.quantidade;
      });

      document.getElementById("total").textContent = total.toFixed(2);
    }

    function alterarQuantidade(index, delta) {
      if (carrinho[index].quantidade + delta >= 1) {
        carrinho[index].quantidade += delta;
        atualizarCarrinho();
      }
    }

    function removerDoCarrinho(index) {
      carrinho.splice(index, 1);
      atualizarCarrinho();
    }

    function limparCarrinho() {
      carrinho.length = 0;
      atualizarCarrinho();
    }

    function verificarPagamento() {
      const forma = document.getElementById("forma-pagamento").value;
      document.getElementById("troco-container").style.display = forma === "Dinheiro" ? "block" : "none";
    }

    function finalizarPedido() {
      const endereco = document.getElementById("endereco").value.trim();
      const formaPagamento = document.getElementById("forma-pagamento").value;
      const troco = document.getElementById("troco").value.trim();

      if (!endereco) return alert("Por favor, informe o endereço.");
      if (carrinho.length === 0) return alert("O carrinho está vazio.");

      let mensagem = "*Novo pedido:*\n\n";
      carrinho.forEach(item => {
        mensagem += `${item.quantidade}x ${item.nome} - R$ ${(item.preco * item.quantidade).toFixed(2)}\n`;
      });

      const total = carrinho.reduce((soma, item) => soma + item.preco * item.quantidade, 0);
      mensagem += `\n*Total:* R$ ${total.toFixed(2)}\n`;
      mensagem += `*Endereço:* ${endereco}\n`;
      mensagem += `*Pagamento:* ${formaPagamento}\n`;

      if (formaPagamento === "Dinheiro" && troco) {
        mensagem += `*Troco para:* R$ ${troco}`;
      }

      const numero = "55996220061";
      const url = `https://wa.me/${numero}?text=${encodeURIComponent(mensagem)}`;
      window.open(url, "_blank");
    }

    renderizarProdutos();
  </script>
</body>
</html>
