<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Delivery Supermercado</title>
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
  />
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background: #f9f9f9;
    }
    header {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 20px;
      flex-wrap: wrap;
      position: sticky;
      top: 0;
      background: white;
      padding: 10px 20px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      z-index: 1000;
    }
    .categorias {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      flex: 1;
    }
    .categoria-btn {
      background: #007bff;
      border: none;
      color: white;
      padding: 8px 14px;
      border-radius: 5px;
      cursor: pointer;
      font-weight: 600;
      transition: background 0.3s;
      user-select: none;
    }
    .categoria-btn:hover,
    .categoria-btn.active {
      background: #0056b3;
    }
    #busca {
      padding: 8px 12px;
      border-radius: 5px;
      border: 1px solid #ccc;
      flex-basis: 250px;
      font-size: 14px;
    }
    #botao-carrinho {
      background: none;
      border: none;
      cursor: pointer;
      font-size: 24px;
      position: relative;
      color: #007bff;
      transition: color 0.3s;
    }
    #botao-carrinho:hover {
      color: #0056b3;
    }
    #botao-carrinho .badge {
      position: absolute;
      top: -6px;
      right: -10px;
      background: red;
      color: white;
      border-radius: 50%;
      font-size: 12px;
      padding: 2px 6px;
      font-weight: bold;
    }

    main {
      display: flex;
      gap: 40px;
      flex-wrap: wrap;
      justify-content: center;
    }
    .produtos {
      display: grid;
      grid-template-columns: repeat(auto-fill,minmax(180px,1fr));
      gap: 18px;
      flex: 2;
      max-width: 900px;
    }
    .produto-card {
      background: white;
      border-radius: 8px;
      box-shadow: 0 3px 8px rgb(0 0 0 / 0.1);
      padding: 10px;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      transition: transform 0.2s;
    }
    .produto-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 6px 14px rgb(0 0 0 / 0.15);
    }
    .produto-card img {
      max-width: 100%;
      border-radius: 6px;
      height: 120px;
      object-fit: contain;
      margin-bottom: 10px;
    }
    .produto-card h3 {
      margin: 6px 0 4px;
      font-size: 16px;
      color: #333;
    }
    .produto-card p {
      color: #555;
      font-weight: 600;
      margin: 0 0 10px;
    }
    .produto-card input[type="number"] {
      width: 50px;
      padding: 5px;
      font-size: 14px;
      border: 1px solid #ccc;
      border-radius: 5px;
      margin-bottom: 8px;
      text-align: center;
    }
    .btn-adicionar {
      background: #28a745;
      color: white;
      border: none;
      padding: 8px 14px;
      border-radius: 5px;
      cursor: pointer;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 6px;
      justify-content: center;
      transition: background 0.3s;
    }
    .btn-adicionar:hover {
      background: #1e7e34;
    }

    .carrinho-container {
      flex: 1;
      max-width: 350px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 3px 8px rgb(0 0 0 / 0.1);
      padding: 15px 20px;
      height: fit-content;
      position: sticky;
      top: 80px;
    }
    .carrinho-container h2 {
      margin-top: 0;
      margin-bottom: 12px;
      font-size: 20px;
      color: #333;
      border-bottom: 2px solid #007bff;
      padding-bottom: 6px;
    }
    #itens-carrinho {
      list-style: none;
      padding: 0;
      margin: 0 0 15px 0;
      max-height: 320px;
      overflow-y: auto;
    }
    #itens-carrinho li {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 6px 0;
      border-bottom: 1px solid #eee;
      font-size: 14px;
      color: #333;
    }
    #itens-carrinho li span {
      flex: 1;
    }
    .controles {
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .qty-btn {
      background: #007bff;
      border: none;
      color: white;
      width: 26px;
      height: 26px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      display: flex;
      justify-content: center;
      align-items: center;
      transition: background 0.3s;
    }
    .qty-btn:hover {
      background: #0056b3;
    }
    .controles button[title="Remover"] {
      background: #dc3545;
      font-size: 16px;
      padding: 2px 6px;
      border-radius: 4px;
      display: flex;
      justify-content: center;
      align-items: center;
      transition: background 0.3s;
    }
    .controles button[title="Remover"]:hover {
      background: #a71d2a;
    }

    #remover-tudo-btn {
      background: #dc3545;
      border: none;
      color: white;
      width: 100%;
      padding: 10px 0;
      font-weight: 700;
      border-radius: 5px;
      cursor: pointer;
      transition: background 0.3s;
      margin-bottom: 15px;
    }
    #remover-tudo-btn:hover {
      background: #a71d2a;
    }
    #total {
      font-weight: 700;
      font-size: 16px;
      text-align: right;
      margin-bottom: 10px;
      color: #007bff;
    }

    form label {
      display: block;
      margin: 8px 0 4px 0;
      font-weight: 600;
      color: #333;
    }
    form input[type="text"],
    form input[type="number"],
    form select {
      width: 100%;
      padding: 7px 8px;
      margin-bottom: 12px;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 14px;
    }
    #troco-container {
      display: none;
    }
    #finalizar-btn {
      background: #007bff;
      color: white;
      border: none;
      padding: 12px 18px;
      border-radius: 5px;
      cursor: pointer;
      font-weight: 700;
      width: 100%;
      font-size: 16px;
      transition: background 0.3s;
    }
    #finalizar-btn:hover {
      background: #0056b3;
    }

    /* Scrollbar carrinho */
    #itens-carrinho::-webkit-scrollbar {
      width: 8px;
    }
    #itens-carrinho::-webkit-scrollbar-thumb {
      background-color: #007bff;
      border-radius: 4px;
    }

    /* Responsividade */
    @media (max-width: 900px) {
      main {
        flex-direction: column;
        align-items: center;
      }
      .carrinho-container {
        position: static;
        width: 100%;
        max-width: none;
        margin-top: 30px;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="categorias" id="categorias"></div>

    <input type="text" id="busca" placeholder="Buscar produto..." oninput="buscarProdutos()" />

    <!-- Botão ícone do carrinho -->
    <button id="botao-carrinho" title="Ver Carrinho" aria-label="Ver Carrinho">
      <i class="fas fa-shopping-cart"></i>
      <span class="badge" id="badge-carrinho">0</span>
    </button>
  </header>

  <main>
    <section class="produtos" id="produtos"></section>

    <section class="carrinho-container" id="carrinho-container" tabindex="-1">
      <h2>Carrinho</h2>
      <button id="remover-tudo-btn" onclick="removerTudo()">Remover Tudo</button>
      <ul id="itens-carrinho"></ul>
      <div id="total">Total: R$ 0.00</div>

      <form id="form-pedido" onsubmit="event.preventDefault(); finalizarPedido();">
        <label for="nome">Nome:</label>
        <input type="text" id="nome" required />

        <label for="endereco">Endereço:</label>
        <input type="text" id="endereco" required />

        <label for="pagamento">Forma de pagamento:</label>
        <select id="pagamento" onchange="mostrarTroco()" required>
          <option value="">Selecione</option>
          <option value="pix">Pix</option>
          <option value="cartao">Cartão</option>
          <option value="dinheiro">Dinheiro</option>
        </select>

        <div id="troco-container">
          <label for="troco">Troco para:</label>
          <input type="number" id="troco" min="0" step="0.01" placeholder="Valor do troco" />
        </div>

        <button id="finalizar-btn" type="submit">
          Finalizar Pedido <i class="fas fa-paper-plane"></i>
        </button>
      </form>
    </section>
  </main>

  <script>
    // Produtos com categoria e imagem
    const produtos = [
      {
        nome: "Arroz Branco 5kg",
        preco: 20.0,
        categoria: "Grãos",
        imagem: "https://i.imgur.com/okZd6Z5.png",
      },
      {
        nome: "Feijão Carioca 1kg",
        preco: 8.5,
        categoria: "Grãos",
        imagem: "https://i.imgur.com/R9vRGyM.png",
      },
      {
        nome: "Leite Integral 1L",
        preco: 4.7,
        categoria: "Laticínios",
        imagem: "https://i.imgur.com/p9R28Ga.png",
      },
      {
        nome: "Queijo Mussarela 500g",
        preco: 18.9,
        categoria: "Laticínios",
        imagem: "https://i.imgur.com/0NqhLLS.png",
      },
      {
        nome: "Banana Nanica 1kg",
        preco: 5.2,
        categoria: "Frutas",
        imagem: "https://i.imgur.com/yJCD5Kw.png",
      },
      {
        nome: "Maçã Fuji 1kg",
        preco: 7.0,
        categoria: "Frutas",
        imagem: "https://i.imgur.com/y5K6c3L.png",
      },
    ];

    let carrinho = [];

    // Renderizar categorias
    function renderizarCategorias() {
      const categorias = [...new Set(produtos.map(p => p.categoria))];
      const divCategorias = document.getElementById("categorias");
      divCategorias.innerHTML = "";

      // Botão para mostrar todos
      const btnTodos = document.createElement("button");
      btnTodos.textContent = "Todos";
      btnTodos.className = "categoria-btn active";
      btnTodos.onclick = () => {
        document.querySelectorAll(".categoria-btn").forEach(b => b.classList.remove("active"));
        btnTodos.classList.add("active");
        renderizarProdutos();
      };
      divCategorias.appendChild(btnTodos);

      categorias.forEach(categoria => {
        const btn = document.createElement("button");
        btn.textContent = categoria;
        btn.className = "categoria-btn";
        btn.onclick = () => {
          document.querySelectorAll(".categoria-btn").forEach(b => b.classList.remove("active"));
          btn.classList.add("active");
          renderizarProdutos(categoria);
        };
        divCategorias.appendChild(btn);
      });
    }

    // Renderizar produtos filtrando por categoria e busca
    function renderizarProdutos(categoria = "") {
      const divProdutos = document.getElementById("produtos");
      const busca = document.getElementById("busca").value.toLowerCase();
      divProdutos.innerHTML = "";

      const filtrados = produtos.filter(p => {
        const porCategoria = categoria ? p.categoria === categoria : true;
        const porBusca = p.nome.toLowerCase().includes(busca);
        return porCategoria && porBusca;
      });

      filtrados.forEach(produto => {
        const card = document.createElement("div");
        card.className = "produto-card";
        card.innerHTML = `
          <img src="${produto.imagem}" alt="${produto.nome}" />
          <h3>${produto.nome}</h3>
          <p>R$ ${produto.preco.toFixed(2)}</p>
          <input type="number" min="1" value="1" id="qtd-${produto.nome.replace(/\s+/g,'')}" />
          <button class="btn-adicionar" onclick="adicionarAoCarrinho('${produto.nome}')">
            <i class="fas fa-cart-plus"></i> Adicionar
          </button>
        `;
        divProdutos.appendChild(card);
      });
    }

    // Buscar produtos ao digitar
    function buscarProdutos() {
      const ativaCategoria = document.querySelector(".categoria-btn.active");
      const categoria = ativaCategoria && ativaCategoria.textContent !== "Todos" ? ativaCategoria.textContent : "";
      renderizarProdutos(categoria);
    }

    // Adicionar ao carrinho
    function adicionarAoCarrinho(nome) {
      const inputQtd = document.getElementById(`qtd-${nome.replace(/\s+/g,'')}`);
      let quantidade = parseInt(inputQtd.value);
      if (isNaN(quantidade) || quantidade < 1) quantidade = 1;

      const produto = produtos.find(p => p.nome === nome);
      if (!produto) return;

      const itemNoCarrinho = carrinho.find(i => i.nome === nome);
      if (itemNoCarrinho) {
        itemNoCarrinho.quantidade += quantidade;
      } else {
        carrinho.push({ nome, preco: produto.preco, quantidade });
      }
      renderizarCarrinho();
      atualizarBadge();
    }

    // Renderizar carrinho com controles
    function renderizarCarrinho() {
      const ul = document.getElementById("itens-carrinho");
      ul.innerHTML = "";

      carrinho.forEach((item, index) => {
        const li = document.createElement("li");

        li.innerHTML = `
          <span>${item.nome} (R$ ${item.preco.toFixed(2)})</span>
          <div class="controles">
            <button class="qty-btn" onclick="alterarQuantidade(${index}, -1)" title="Diminuir quantidade"><i class="fas fa-minus"></i></button>
            <span>${item.quantidade}</span>
            <button class="qty-btn" onclick="alterarQuantidade(${index}, 1)" title="Aumentar quantidade"><i class="fas fa-plus"></i></button>
            <button onclick="removerItem(${index})" title="Remover item"><i class="fas fa-trash"></i></button>
          </div>
        `;
        ul.appendChild(li);
      });

      atualizarTotal();
      atualizarBadge();
    }

    // Alterar quantidade no carrinho
    function alterarQuantidade(index, delta) {
      carrinho[index].quantidade += delta;
      if (carrinho[index].quantidade < 1) {
        carrinho.splice(index, 1);
      }
      renderizarCarrinho();
    }

    // Remover item do carrinho
    function removerItem(index) {
      carrinho.splice(index, 1);
      renderizarCarrinho();
    }

    // Remover tudo do carrinho
    function removerTudo() {
      if (confirm("Tem certeza que deseja limpar o carrinho?")) {
        carrinho = [];
        renderizarCarrinho();
      }
    }

    // Atualizar total do carrinho
    function atualizarTotal() {
      const totalDiv = document.getElementById("total");
      const total = carrinho.reduce((acc, item) => acc + item.preco * item.quantidade, 0);
      totalDiv.textContent = `Total: R$ ${total.toFixed(2)}`;
    }

    // Mostrar campo troco quando selecionar dinheiro
    function mostrarTroco() {
      const pagamento = document.getElementById("pagamento").value;
      const trocoContainer = document.getElementById("troco-container");
      if (pagamento === "dinheiro") {
        trocoContainer.style.display = "block";
      } else {
        trocoContainer.style.display = "none";
      }
    }

    // Finalizar pedido
    function finalizarPedido() {
      if (carrinho.length === 0) {
        alert("Seu carrinho está vazio!");
        return;
      }
      const nome = document.getElementById("nome").value.trim();
      const endereco = document.getElementById("endereco").value.trim();
      const pagamento = document.getElementById("pagamento").value;
      if (!nome || !endereco || !pagamento) {
        alert("Por favor, preencha todos os campos e escolha a forma de pagamento.");
        return;
      }
      let troco = "";
      if (pagamento === "dinheiro") {
        const trocoInput = document.getElementById("troco").value;
        troco = trocoInput ? `\nTroco para: R$ ${parseFloat(trocoInput).toFixed(2)}` : "";
      }
      let mensagem = `Pedido de ${nome}\nEndereço: ${endereco}\nForma de pagamento: ${pagamento}${troco}\n\nItens:\n`;
      carrinho.forEach(item => {
        mensagem += `- ${item.nome} x ${item.quantidade} = R$ ${(item.preco * item.quantidade).toFixed(2)}\n`;
      });
      const total = carrinho.reduce((acc, item) => acc + item.preco * item.quantidade, 0);
      mensagem += `\nTotal: R$ ${total.toFixed(2)}`;

      alert("Pedido enviado com sucesso!\n\n" + mensagem);

      // Limpar
      carrinho = [];
      renderizarCarrinho();
      document.getElementById("form-pedido").reset();
      mostrarTroco();
    }

    // Atualiza o badge do ícone do carrinho
    function atualizarBadge() {
      const badge = document.getElementById("badge-carrinho");
      const totalItens = carrinho.reduce((acc, item) => acc + item.quantidade, 0);
      badge.textContent = totalItens;
      badge.style.display = totalItens > 0 ? "inline-block" : "none";
    }

    // Scroll até o carrinho ao clicar no ícone
    document.getElementById("botao-carrinho").addEventListener("click", () => {
      const carrinhoSection = document.getElementById("carrinho-container");
      carrinhoSection.scrollIntoView({ behavior: "smooth" });
      carrinhoSection.focus();
    });

    // Inicialização
    renderizarCategorias();
    renderizarProdutos();
    renderizarCarrinho();
    atualizarBadge();
  </script>
</body>
</html>
