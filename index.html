<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Delivery Supermercado</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0; padding: 0;
      background: #f8f8f8;
    }
    header {
      display: flex;
      align-items: center;
      background: #2e8b57;
      color: white;
      padding: 10px 20px;
      position: sticky;
      top: 0;
      z-index: 1000;
    }
    #categorias {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      margin-left: 20px;
      flex-grow: 1;
    }
    #categorias button {
      background: white;
      border: none;
      padding: 8px 14px;
      border-radius: 20px;
      color: #2e8b57;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    #categorias button:hover,
    #categorias button.active {
      background: #196f3d;
      color: white;
    }
    #busca {
      padding: 6px 10px;
      border-radius: 20px;
      border: none;
      width: 180px;
      margin-right: 20px;
    }
    #botao-carrinho {
      position: relative;
      background: transparent;
      border: none;
      cursor: pointer;
      color: white;
      font-size: 24px;
    }
    #botao-carrinho:hover {
      color: #a3d9a5;
    }
    #badge-carrinho {
      position: absolute;
      top: 0;
      right: -5px;
      background: red;
      color: white;
      font-size: 12px;
      border-radius: 50%;
      padding: 2px 6px;
      display: none;
      font-weight: bold;
    }
    main {
      display: flex;
      flex-wrap: wrap;
      padding: 20px;
      gap: 20px;
      justify-content: center;
      background: #f8f8f8;
    }
    .produto-card {
      background: white;
      border-radius: 8px;
      box-shadow: 0 3px 6px rgba(0,0,0,0.1);
      width: 180px;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 10px;
      transition: transform 0.2s;
    }
    .produto-card:hover {
      transform: scale(1.05);
    }
    .produto-card img {
      width: 150px;
      height: 150px;
      object-fit: contain;
      border-radius: 8px;
    }
    .produto-nome {
      font-weight: bold;
      margin: 10px 0 5px;
      text-align: center;
      min-height: 40px;
    }
    .produto-preco {
      color: #2e8b57;
      font-weight: bold;
      margin-bottom: 10px;
    }
    .produto-actions {
      display: flex;
      gap: 5px;
      width: 100%;
      justify-content: center;
    }
    .produto-actions button {
      flex: 1;
      padding: 6px 8px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
      color: white;
      background-color: #2e8b57;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 5px;
      transition: background-color 0.3s;
    }
    .produto-actions button:hover {
      background-color: #196f3d;
    }
    /* √çcones simples com Unicode */
    .icon-plus::before {
      content: "+";
      font-weight: bold;
    }
    .icon-minus::before {
      content: "-";
      font-weight: bold;
    }
    .icon-cart::before {
      content: "üõí";
    }
    /* Carrinho */
    #carrinho-container {
      background: white;
      box-shadow: 0 3px 12px rgba(0,0,0,0.15);
      padding: 15px;
      border-radius: 8px;
      width: 350px;
      position: fixed;
      right: 20px;
      top: 70px;
      bottom: 20px;
      overflow-y: auto;
      font-size: 14px;
      display: flex;
      flex-direction: column;
      z-index: 2000;
    }
    #carrinho-container h2 {
      margin-top: 0;
      color: #2e8b57;
      text-align: center;
    }
    .item-carrinho {
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid #ddd;
      padding: 8px 0;
      gap: 10px;
    }
    .item-info {
      flex: 1;
      min-width: 0;
    }
    .item-nome {
      font-weight: bold;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .item-quantidade {
      display: flex;
      align-items: center;
      gap: 5px;
      margin-top: 5px;
    }
    .item-quantidade button {
      background: #2e8b57;
      border: none;
      color: white;
      padding: 2px 8px;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
    }
    .item-quantidade span {
      min-width: 20px;
      text-align: center;
    }
    .item-preco {
      min-width: 65px;
      text-align: right;
      font-weight: bold;
      color: #2e8b57;
    }
    .item-remover {
      background: #cc3d3d;
      border: none;
      color: white;
      border-radius: 4px;
      padding: 4px 6px;
      cursor: pointer;
      font-weight: bold;
      font-size: 12px;
    }
    #total {
      font-weight: bold;
      text-align: right;
      margin-top: 10px;
      color: #2e8b57;
      font-size: 16px;
    }
    #limpar-carrinho {
      margin-top: 10px;
      padding: 8px;
      border: none;
      background-color: #cc3d3d;
      color: white;
      cursor: pointer;
      border-radius: 5px;
      font-weight: bold;
    }
    form#form-pedido {
      margin-top: 15px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    form#form-pedido input, 
    form#form-pedido select {
      padding: 8px;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 14px;
      width: 100%;
      box-sizing: border-box;
    }
    #troco-container {
      display: none;
    }
    form#form-pedido button[type="submit"],
    form#form-pedido button[type="button"] {
      background-color: #2e8b57;
      color: white;
      border: none;
      padding: 10px;
      border-radius: 5px;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    form#form-pedido button[type="submit"]:hover,
    form#form-pedido button[type="button"]:hover {
      background-color: #196f3d;
    }

    /* Responsivo */
    @media (max-width: 768px) {
      #carrinho-container {
        position: static;
        width: 100%;
        height: auto;
        max-height: none;
        margin-top: 20px;
      }
      main {
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <header>
    <strong>Delivery Supermercado</strong>
    <nav id="categorias"></nav>
    <input type="text" id="busca" placeholder="Buscar produto..." />
    <button id="botao-carrinho" title="Ver carrinho">
      üõí <span id="badge-carrinho">0</span>
    </button>
  </header>

  <main id="produtos-container"></main>

  <section id="carrinho-container" tabindex="-1" aria-label="Carrinho de compras">
    <h2>Carrinho</h2>
    <div id="itens-carrinho"></div>
    <div id="total">Total: R$ 0.00</div>
    <button id="limpar-carrinho">Limpar carrinho</button>

    <form id="form-pedido" onsubmit="event.preventDefault(); finalizarPedido();">
      <input type="text" id="nome" placeholder="Seu nome" required />
      <input type="text" id="endereco" placeholder="Endere√ßo de entrega" required />
      <select id="pagamento" onchange="mostrarTroco()" required>
        <option value="" disabled selected>Forma de pagamento</option>
        <option value="pix">Pix</option>
        <option value="cartao">Cart√£o</option>
        <option value="dinheiro">Dinheiro</option>
      </select>
      <div id="troco-container">
        <input type="number" id="troco" min="0" step="0.01" placeholder="Troco para quanto?" />
      </div>
      <button type="submit">Finalizar pedido</button>
      <button type="button" onclick="enviarWhatsApp()" style="margin-left: 10px;">Enviar pedido pelo WhatsApp</button>
    </form>
  </section>

  <script>
    // Dados dos produtos (exemplo com imagens e categorias)
    const produtos = [
      { id: 1, nome: "Arroz 5kg", preco: 20.5, categoria: "Gr√£os", imagem: "https://cdn-icons-png.flaticon.com/512/3075/3075977.png" },
      { id: 2, nome: "Feij√£o 1kg", preco: 7.9, categoria: "Gr√£os", imagem: "https://cdn-icons-png.flaticon.com/512/1046/1046750.png" },
      { id: 3, nome: "Leite Integral 1L", preco: 4.5, categoria: "Latic√≠nios", imagem: "https://cdn-icons-png.flaticon.com/512/3664/3664850.png" },
      { id: 4, nome: "Queijo Mussarela 500g", preco: 15.3, categoria: "Latic√≠nios", imagem: "https://cdn-icons-png.flaticon.com/512/149/149852.png" },
      { id: 5, nome: "Banana", preco: 2.8, categoria: "Frutas", imagem: "https://cdn-icons-png.flaticon.com/512/415/415733.png" },
      { id: 6, nome: "Ma√ß√£", preco: 3.2, categoria: "Frutas", imagem: "https://cdn-icons-png.flaticon.com/512/415/415750.png" },
      { id: 7, nome: "Tomate", preco: 3.0, categoria: "Legumes", imagem: "https://cdn-icons-png.flaticon.com/512/135/135620.png" },
      { id: 8, nome: "Batata", preco: 2.5, categoria: "Legumes", imagem: "https://cdn-icons-png.flaticon.com/512/135/135621.png" },
    ];

    let carrinho = [];

    // Pega categorias √∫nicas dos produtos
    function getCategorias() {
      const cats = produtos.map(p => p.categoria);
      return [...new Set(cats)];
    }

    // Renderiza categorias na barra superior
    function renderizarCategorias() {
      const container = document.getElementById("categorias");
      const categorias = getCategorias();
      container.innerHTML = '';
      const btnTodos = document.createElement("button");
      btnTodos.textContent = "Todos";
      btnTodos.classList.add("active");
      btnTodos.onclick = () => {
        document.querySelectorAll("#categorias button").forEach(btn => btn.classList.remove("active"));
        btnTodos.classList.add("active");
        renderizarProdutos();
      };
      container.appendChild(btnTodos);

      categorias.forEach(categoria => {
        const btn = document.createElement("button");
        btn.textContent = categoria;
        btn.onclick = () => {
          document.querySelectorAll("#categorias button").forEach(btn => btn.classList.remove("active"));
          btn.classList.add("active");
          renderizarProdutos(categoria);
        };
        container.appendChild(btn);
      });
    }

    // Renderiza produtos (filtrados por categoria e busca)
    function renderizarProdutos(categoriaSelecionada = null) {
      const container = document.getElementById("produtos-container");
      const busca = document.getElementById("busca").value.toLowerCase();
      container.innerHTML = '';

      const produtosFiltrados = produtos.filter(p => {
        const condCategoria = categoriaSelecionada ? p.categoria === categoriaSelecionada : true;
        const condBusca = p.nome.toLowerCase().includes(busca);
        return condCategoria && condBusca;
      });

      if (produtosFiltrados.length === 0) {
        container.textContent = "Nenhum produto encontrado.";
        return;
      }

      produtosFiltrados.forEach(produto => {
        const card = document.createElement("div");
        card.className = "produto-card";

        const img = document.createElement("img");
        img.src = produto.imagem;
        img.alt = produto.nome;
        card.appendChild(img);

        const nome = document.createElement("div");
        nome.className = "produto-nome";
        nome.textContent = produto.nome;
        card.appendChild(nome);

        const preco = document.createElement("div");
        preco.className = "produto-preco";
        preco.textContent = `R$ ${produto.preco.toFixed(2)}`;
        card.appendChild(preco);

        const actions = document.createElement("div");
        actions.className = "produto-actions";

        const btnAdd = document.createElement("button");
        btnAdd.innerHTML = '<span class="icon-cart"></span> Comprar';
        btnAdd.onclick = () => adicionarAoCarrinho(produto.id);
        actions.appendChild(btnAdd);

        card.appendChild(actions);
        container.appendChild(card);
      });
    }

    // Adiciona produto ao carrinho
    function adicionarAoCarrinho(produtoId) {
      const produto = produtos.find(p => p.id === produtoId);
      const item = carrinho.find(i => i.id === produtoId);
      if (item) {
        item.quantidade++;
      } else {
        carrinho.push({ ...produto, quantidade: 1 });
      }
      renderizarCarrinho();
      atualizarBadge();
    }

    // Renderiza carrinho
    function renderizarCarrinho() {
      const container = document.getElementById("itens-carrinho");
      container.innerHTML = '';

      carrinho.forEach(item => {
        const div = document.createElement("div");
        div.className = "item-carrinho";

        const info = document.createElement("div");
        info.className = "item-info";

        const nome = document.createElement("div");
        nome.className = "item-nome";
        nome.textContent = item.nome;
        info.appendChild(nome);

        const quantidade = document.createElement("div");
        quantidade.className = "item-quantidade";

        const btnMenos = document.createElement("button");
        btnMenos.textContent = "-";
        btnMenos.title = "Diminuir quantidade";
        btnMenos.onclick = () => {
          if (item.quantidade > 1) {
            item.quantidade--;
          } else {
            carrinho = carrinho.filter(i => i.id !== item.id);
          }
          renderizarCarrinho();
          atualizarBadge();
        };
        quantidade.appendChild(btnMenos);

        const spanQtd = document.createElement("span");
        spanQtd.textContent = item.quantidade;
        quantidade.appendChild(spanQtd);

        const btnMais = document.createElement("button");
        btnMais.textContent = "+";
        btnMais.title = "Aumentar quantidade";
        btnMais.onclick = () => {
          item.quantidade++;
          renderizarCarrinho();
          atualizarBadge();
        };
        quantidade.appendChild(btnMais);

        info.appendChild(quantidade);
        div.appendChild(info);

        const preco = document.createElement("div");
        preco.className = "item-preco";
        preco.textContent = `R$ ${(item.preco * item.quantidade).toFixed(2)}`;
        div.appendChild(preco);

        const btnRemover = document.createElement("button");
        btnRemover.className = "item-remover";
        btnRemover.textContent = "X";
        btnRemover.title = "Remover do carrinho";
        btnRemover.onclick = () => {
          carrinho = carrinho.filter(i => i.id !== item.id);
          renderizarCarrinho();
          atualizarBadge();
        };
        div.appendChild(btnRemover);

        container.appendChild(div);
      });

      const total = carrinho.reduce((acc, item) => acc + item.preco * item.quantidade, 0);
      document.getElementById("total").textContent = `Total: R$ ${total.toFixed(2)}`;

      // Mostrar/ocultar form pedido dependendo se tem itens
      document.getElementById("form-pedido").style.display = carrinho.length ? "flex" : "none";
    }

    // Atualiza badge do carrinho no topo
    function atualizarBadge() {
      const badge = document.getElementById("badge-carrinho");
      const totalQtd = carrinho.reduce((acc, item) => acc + item.quantidade, 0);
      if (totalQtd > 0) {
        badge.style.display = "inline-block";
        badge.textContent = totalQtd;
      } else {
        badge.style.display = "none";
      }
    }

    // Limpar carrinho
    document.getElementById("limpar-carrinho").onclick = () => {
      if (confirm("Deseja realmente limpar o carrinho?")) {
        carrinho = [];
        renderizarCarrinho();
        atualizarBadge();
      }
    };

    // Mostrar campo troco somente se pagamento for dinheiro
    function mostrarTroco() {
      const forma = document.getElementById("pagamento").value;
      const containerTroco = document.getElementById("troco-container");
      if (forma === "dinheiro") {
        containerTroco.style.display = "block";
      } else {
        containerTroco.style.display = "none";
        document.getElementById("troco").value = "";
      }
    }

    // Finalizar pedido (apenas alerta simples)
    function finalizarPedido() {
      if (carrinho.length === 0) {
        alert("Seu carrinho est√° vazio!");
        return;
      }
      const nome = document.getElementById("nome").value.trim();
      const endereco = document.getElementById("endereco").value.trim();
      const pagamento = document.getElementById("pagamento").value;
      if (!nome || !endereco || !pagamento) {
        alert("Por favor, preencha todos os campos e escolha a forma de pagamento.");
        return;
      }
      alert("Pedido finalizado com sucesso! Em breve entraremos em contato.");
      // Aqui voc√™ poderia limpar o carrinho e formul√°rio se quiser
      carrinho = [];
      renderizarCarrinho();
      atualizarBadge();
      document.getElementById("form-pedido").reset();
      mostrarTroco();
    }

    // Fun√ß√£o para enviar o pedido via WhatsApp
    function enviarWhatsApp() {
      if (carrinho.length === 0) {
        alert("Seu carrinho est√° vazio!");
        return;
      }
      const nome = document.getElementById("nome").value.trim();
      const endereco = document.getElementById("endereco").value.trim();
      const pagamento = document.getElementById("pagamento").value;
      if (!nome || !endereco || !pagamento) {
        alert("Por favor, preencha todos os campos e escolha a forma de pagamento.");
        return;
      }
      let troco = "";
      if (pagamento === "dinheiro") {
        const trocoInput = document.getElementById("troco").value;
        troco = trocoInput ? `\nTroco para: R$ ${parseFloat(trocoInput).toFixed(2)}` : "";
      }
      let mensagem = `*Pedido de ${nome}*\nEndere√ßo: ${endereco}\nForma de pagamento: ${pagamento}${troco}\n\n*Itens:*`;
      carrinho.forEach(item => {
        mensagem += `\n- ${item.nome} x ${item.quantidade} = R$ ${(item.preco * item.quantidade).toFixed(2)}`;
      });
      const total = carrinho.reduce((acc, item) => acc + item.preco * item.quantidade, 0);
      mensagem += `\n\n*Total: R$ ${total.toFixed(2)}*`;

      const telefoneLoja = "5584996220061"; // Troque para seu n√∫mero real no formato DDI + DDD + n√∫mero

      const urlWhatsApp = `https://wa.me/${telefoneLoja}?text=${encodeURIComponent(mensagem)}`;

      window.open(urlWhatsApp, "_blank");
    }

    // Busca ao digitar
    document.getElementById("busca").addEventListener("input", () => {
      const ativo = document.querySelector("#categorias button.active");
      const cat = ativo && ativo.textContent !== "Todos" ? ativo.textContent : null;
      renderizarProdutos(cat);
    });

    // Mostrar/ocultar carrinho ao clicar no bot√£o do topo
    document.getElementById("botao-carrinho").addEventListener("click", () => {
      const carrinhoContainer = document.getElementById("carrinho-container");
      if (carrinhoContainer.style.display === "none" || carrinhoContainer.style.display === "") {
        carrinhoContainer.style.display = "flex";
        carrinhoContainer.focus();
      } else {
        carrinhoContainer.style.display = "none";
      }
    });

    // Inicializa√ß√£o
    renderizarCategorias();
    renderizarProdutos();
    renderizarCarrinho();
    atualizarBadge();
  </script>
</body>
</html>
