<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Delivery Supermercado</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0; padding: 0;
      background: #f5f5f5;
    }
    header {
      background: #2a9d8f;
      color: white;
      padding: 15px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: sticky;
      top: 0;
      z-index: 100;
    }
    header h1 {
      margin: 0;
      font-size: 1.5rem;
    }
    #busca {
      padding: 6px 10px;
      font-size: 1rem;
      border-radius: 5px;
      border: none;
      outline: none;
    }
    #botao-carrinho {
      background: transparent;
      border: none;
      cursor: pointer;
      position: relative;
      font-size: 1.5rem;
      color: white;
    }
    #badge-carrinho {
      background: #e76f51;
      color: white;
      font-size: 0.8rem;
      padding: 2px 6px;
      border-radius: 50%;
      position: absolute;
      top: -5px;
      right: -10px;
      display: none;
      user-select: none;
    }
    #categorias {
      display: flex;
      gap: 10px;
      background: #264653;
      padding: 10px 20px;
      flex-wrap: wrap;
    }
    #categorias button {
      background: #2a9d8f;
      color: white;
      border: none;
      padding: 8px 14px;
      border-radius: 20px;
      cursor: pointer;
      font-weight: bold;
      transition: background-color 0.3s;
      white-space: nowrap;
    }
    #categorias button.active,
    #categorias button:hover {
      background: #e9c46a;
      color: #264653;
    }
    main {
      display: flex;
      padding: 20px;
      gap: 20px;
      flex-wrap: wrap;
    }
    #produtos {
      flex: 1;
      display: grid;
      grid-template-columns: repeat(auto-fill,minmax(200px,1fr));
      gap: 20px;
    }
    .card {
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgb(0 0 0 / 0.15);
      padding: 15px;
      display: flex;
      flex-direction: column;
      align-items: center;
      transition: transform 0.2s;
    }
    .card:hover {
      transform: scale(1.03);
    }
    .card img {
      max-width: 100%;
      border-radius: 6px;
      margin-bottom: 10px;
      height: 120px;
      object-fit: contain;
    }
    .card h3 {
      margin: 0 0 10px;
      font-size: 1.1rem;
      text-align: center;
      flex-grow: 1;
    }
    .card p {
      margin: 0 0 10px;
      font-weight: bold;
      font-size: 1.1rem;
      color: #2a9d8f;
    }
    .card input[type="number"] {
      width: 50px;
      margin-bottom: 10px;
      font-size: 1rem;
      padding: 4px;
    }
    .card button {
      background: #2a9d8f;
      color: white;
      border: none;
      border-radius: 5px;
      padding: 8px 12px;
      cursor: pointer;
      font-weight: bold;
      transition: background-color 0.3s;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .card button:hover {
      background: #21867a;
    }
    /* Carrinho lateral */
    #carrinho-container {
      position: fixed;
      top: 0; right: 0;
      width: 320px;
      height: 100vh;
      background: white;
      box-shadow: -3px 0 8px rgb(0 0 0 / 0.2);
      padding: 20px;
      overflow-y: auto;
      display: none;
      flex-direction: column;
      z-index: 200;
    }
    #carrinho-container h2 {
      margin-top: 0;
      font-size: 1.5rem;
      border-bottom: 1px solid #ccc;
      padding-bottom: 10px;
      margin-bottom: 15px;
      position: relative;
    }
    /* Bot√£o fechar carrinho */
    #fechar-carrinho {
      position: absolute;
      top: 10px;
      right: 10px;
      background: transparent;
      border: none;
      font-size: 1.5rem;
      font-weight: bold;
      cursor: pointer;
      color: #e76f51;
      line-height: 1;
      user-select: none;
    }
    .item-carrinho {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
      gap: 8px;
      border-bottom: 1px solid #eee;
      padding-bottom: 8px;
    }
    .item-carrinho > div {
      flex: 1;
    }
    .item-carrinho span {
      font-weight: bold;
      color: #264653;
    }
    .item-quantidade {
      display: flex;
      align-items: center;
      gap: 5px;
    }
    .item-quantidade button {
      background: #2a9d8f;
      color: white;
      border: none;
      border-radius: 3px;
      width: 25px;
      height: 25px;
      font-size: 18px;
      cursor: pointer;
      line-height: 1;
    }
    .item-remover {
      background: #e76f51;
      border: none;
      color: white;
      border-radius: 4px;
      padding: 5px 9px;
      cursor: pointer;
      font-weight: bold;
      font-size: 14px;
    }
    #total {
      font-weight: bold;
      font-size: 1.3rem;
      margin-top: 10px;
      color: #264653;
    }
    #limpar-carrinho {
      background: #e76f51;
      color: white;
      border: none;
      border-radius: 6px;
      padding: 10px 12px;
      margin-top: 15px;
      cursor: pointer;
      font-weight: bold;
      width: 100%;
      font-size: 1rem;
    }
    /* Formul√°rio */
    #form-pedido {
      margin-top: 20px;
      display: none;
      flex-direction: column;
      gap: 10px;
    }
    #form-pedido input,
    #form-pedido select {
      padding: 10px;
      font-size: 1rem;
      border-radius: 6px;
      border: 1px solid #ccc;
      outline: none;
    }
    #form-pedido input:focus,
    #form-pedido select:focus {
      border-color: #2a9d8f;
    }
    #troco-container {
      display: none;
    }
    .form-buttons {
      margin-top: 10px;
    }
    .form-buttons button {
      width: 100%;
      padding: 12px;
      font-size: 1.1rem;
      background: #2a9d8f;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      transition: background-color 0.3s;
    }
    .form-buttons button:hover {
      background: #21867a;
    }
	@media screen and (max-width: 768px){
		.colaborador img{
			width: 30%;
		}
    main {
      flex-direction: column;
    }
    #carrinho-container {
      width: 100%;
      height: 50vh;
      bottom: 0;
      top: auto;
      right: 0;
      left: 0;
      box-shadow: 0 -3px 8px rgb(0 0 0 / 0.2);
    }
	}
  </style>
</head>
<body>
  <header>
    <h1>Supermercado Delivery</h1>
    <input type="text" id="busca" placeholder="Buscar produto..." aria-label="Buscar produto" />
    <button id="botao-carrinho" title="Ver carrinho" aria-label="Abrir carrinho">
      üõí <span id="badge-carrinho" aria-live="polite" aria-atomic="true"></span>
    </button>
  </header>

  <nav id="categorias" aria-label="Categorias de produtos"></nav>

  <main>
    <section id="produtos" aria-live="polite" aria-atomic="true" aria-label="Lista de produtos">
      <!-- Cards dos produtos aparecer√£o aqui -->
    </section>

    <aside id="carrinho-container" aria-label="Carrinho de compras" role="region" aria-hidden="true">
      <h2>Carrinho
        <button id="fechar-carrinho" aria-label="Fechar carrinho">&times;</button>
      </h2>
      <div id="itens-carrinho" tabindex="0"></div>
      <div id="total">Total: R$ 0,00</div>
      <button id="limpar-carrinho" aria-label="Limpar carrinho">Limpar Carrinho</button>

      <form id="form-pedido" aria-label="Formul√°rio de pedido">
        <input type="text" id="nome" placeholder="Nome completo" required aria-required="true" />
        <input type="tel" id="telefone" placeholder="Telefone" required aria-required="true" />
        <input type="text" id="endereco" placeholder="Endere√ßo completo" required aria-required="true" />
        <select id="pagamento" required aria-required="true">
          <option value="" disabled selected>Forma de pagamento</option>
          <option value="dinheiro">Dinheiro</option>
          <option value="cartao">Cart√£o de Cr√©dito/D√©bito</option>
          <option value="pix">PIX</option>
        </select>

        <div id="troco-container">
          <input type="number" id="troco" min="0" placeholder="Valor para troco" />
        </div>

        <div class="form-buttons">
          <button type="submit" id="enviar-pedido">Enviar Pedido</button>
        </div>
      </form>
    </aside>
  </main>

<script>
  const produtos = [
    {
      id: 1,
      nome: "Arroz Integral",
      categoria: "Alimentos",
      preco: 12.90,
      imagem: "https://cdn-icons-png.flaticon.com/512/3064/3064197.png"
    },
    {
      id: 2,
      nome: "Feij√£o Preto",
      categoria: "Alimentos",
      preco: 8.50,
      imagem: "https://cdn-icons-png.flaticon.com/512/1046/1046784.png"
    },
    {
      id: 3,
      nome: "Leite Integral",
      categoria: "Latic√≠nios",
      preco: 5.20,
      imagem: "https://cdn-icons-png.flaticon.com/512/616/616408.png"
    },
    {
      id: 4,
      nome: "Queijo Minas",
      categoria: "Latic√≠nios",
      preco: 22.30,
      imagem: "https://cdn-icons-png.flaticon.com/512/2305/2305333.png"
    },
    {
      id: 5,
      nome: "Tomate",
      categoria: "Verduras",
      preco: 4.90,
      imagem: "https://cdn-icons-png.flaticon.com/512/135/135763.png"
    },
    {
      id: 6,
      nome: "Alface",
      categoria: "Verduras",
      preco: 3.20,
      imagem: "https://cdn-icons-png.flaticon.com/512/415/415733.png"
    },
    {
      id: 7,
      nome: "Chocolate 70%",
      categoria: "Doces",
      preco: 15.90,
      imagem: "https://cdn-icons-png.flaticon.com/512/2614/2614180.png"
    },
    {
      id: 8,
      nome: "Biscoito Integral",
      categoria: "Doces",
      preco: 6.50,
      imagem: "https://cdn-icons-png.flaticon.com/512/590/590685.png"
    }
  ];

  const categorias = [...new Set(produtos.map(p => p.categoria))];

  const produtosContainer = document.getElementById('produtos');
  const categoriasContainer = document.getElementById('categorias');
  const carrinhoContainer = document.getElementById('carrinho-container');
  const botaoCarrinho = document.getElementById('botao-carrinho');
  const fecharCarrinhoBtn = document.getElementById('fechar-carrinho');
  const itensCarrinhoContainer = document.getElementById('itens-carrinho');
  const totalCarrinho = document.getElementById('total');
  const limparCarrinhoBtn = document.getElementById('limpar-carrinho');
  const badgeCarrinho = document.getElementById('badge-carrinho');
  const buscaInput = document.getElementById('busca');

  const formPedido = document.getElementById('form-pedido');
  const pagamentoSelect = document.getElementById('pagamento');
  const trocoContainer = document.getElementById('troco-container');
  const trocoInput = document.getElementById('troco');

  let carrinho = {};

  // Fun√ß√£o para salvar carrinho no localStorage
  function salvarCarrinho() {
    localStorage.setItem('carrinho', JSON.stringify(carrinho));
  }

  // Fun√ß√£o para carregar carrinho do localStorage
  function carregarCarrinho() {
    const carrinhoStorage = localStorage.getItem('carrinho');
    if (carrinhoStorage) {
      carrinho = JSON.parse(carrinhoStorage);
    }
  }

  // Formata valor para moeda BRL
  function formatarPreco(valor) {
    return valor.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
  }

  // Exibe categorias dinamicamente
  function mostrarCategorias() {
    categoriasContainer.innerHTML = '';
    const btnTodas = document.createElement('button');
    btnTodas.textContent = 'Todas';
    btnTodas.classList.add('active');
    btnTodas.addEventListener('click', () => {
      filtrarProdutos('');
      ativarCategoria(btnTodas);
    });
    categoriasContainer.appendChild(btnTodas);

    categorias.forEach(cat => {
      const btn = document.createElement('button');
      btn.textContent = cat;
      btn.addEventListener('click', () => {
        filtrarProdutos(cat);
        ativarCategoria(btn);
      });
      categoriasContainer.appendChild(btn);
    });
  }

  function ativarCategoria(botao) {
    const botoes = categoriasContainer.querySelectorAll('button');
    botoes.forEach(b => b.classList.remove('active'));
    botao.classList.add('active');
  }

  // Exibe produtos, pode filtrar por categoria e texto busca
  function mostrarProdutos(produtosParaMostrar) {
    produtosContainer.innerHTML = '';
    if (produtosParaMostrar.length === 0) {
      produtosContainer.innerHTML = '<p>Nenhum produto encontrado.</p>';
      return;
    }
    produtosParaMostrar.forEach(produto => {
      const card = document.createElement('div');
      card.className = 'card';
      card.innerHTML = `
        <img src="${produto.imagem}" alt="${produto.nome}" />
        <h3>${produto.nome}</h3>
        <p>${formatarPreco(produto.preco)}</p>
        <input type="number" min="1" max="100" value="1" aria-label="Quantidade de ${produto.nome}" />
        <button aria-label="Adicionar ${produto.nome} ao carrinho">Adicionar üõí</button>
      `;
      const inputQuantidade = card.querySelector('input');
      const btnAdicionar = card.querySelector('button');
      btnAdicionar.addEventListener('click', () => {
        let quantidade = parseInt(inputQuantidade.value);
        if (isNaN(quantidade) || quantidade < 1) quantidade = 1;
        adicionarAoCarrinho(produto.id, quantidade);
        inputQuantidade.value = '1';
      });
      produtosContainer.appendChild(card);
    });
  }

  // Filtra produtos por categoria e busca
  function filtrarProdutos(categoria = '') {
    const termoBusca = buscaInput.value.trim().toLowerCase();
    let filtrados = produtos.filter(p => {
      const matchCategoria = categoria === '' || p.categoria === categoria;
      const matchBusca = p.nome.toLowerCase().includes(termoBusca);
      return matchCategoria && matchBusca;
    });
    mostrarProdutos(filtrados);
  }

  // Adiciona produto ao carrinho
  function adicionarAoCarrinho(id, quantidade) {
    if (carrinho[id]) {
      carrinho[id] += quantidade;
    } else {
      carrinho[id] = quantidade;
    }
    salvarCarrinho();
    atualizarBadgeCarrinho();
    alert('Produto adicionado ao carrinho!');
  }

  // Remove produto do carrinho
  function removerDoCarrinho(id) {
    delete carrinho[id];
    salvarCarrinho();
    atualizarCarrinho();
    atualizarBadgeCarrinho();
  }

  // Atualiza quantidade no carrinho (para bot√µes + e -)
  function alterarQuantidadeCarrinho(id, novaQuantidade) {
    if (novaQuantidade < 1) {
      removerDoCarrinho(id);
    } else {
      carrinho[id] = novaQuantidade;
      salvarCarrinho();
      atualizarCarrinho();
      atualizarBadgeCarrinho();
    }
  }

  // Atualiza badge do carrinho
  function atualizarBadgeCarrinho() {
    const totalItens = Object.values(carrinho).reduce((acc, q) => acc + q, 0);
    if (totalItens > 0) {
      badgeCarrinho.style.display = 'inline-block';
      badgeCarrinho.textContent = totalItens;
    } else {
      badgeCarrinho.style.display = 'none';
      badgeCarrinho.textContent = '';
    }
  }

  // Atualiza o conte√∫do do carrinho lateral
  function atualizarCarrinho() {
    itensCarrinhoContainer.innerHTML = '';

    const ids = Object.keys(carrinho);
    if (ids.length === 0) {
      itensCarrinhoContainer.innerHTML = '<p>Carrinho vazio.</p>';
      totalCarrinho.textContent = 'Total: R$ 0,00';
      formPedido.style.display = 'none';
      return;
    }

    let somaTotal = 0;

    ids.forEach(id => {
      const produto = produtos.find(p => p.id == id);
      const quantidade = carrinho[id];
      const subtotal = produto.preco * quantidade;
      somaTotal += subtotal;

      const itemDiv = document.createElement('div');
      itemDiv.className = 'item-carrinho';

      itemDiv.innerHTML = `
        <div><strong>${produto.nome}</strong></div>
        <div class="item-quantidade" aria-label="Quantidade do produto ${produto.nome}">
          <button aria-label="Diminuir quantidade de ${produto.nome}" data-action="diminuir" data-id="${id}">-</button>
          <span>${quantidade}</span>
          <button aria-label="Aumentar quantidade de ${produto.nome}" data-action="aumentar" data-id="${id}">+</button>
        </div>
        <div>${formatarPreco(subtotal)}</div>
        <button class="item-remover" aria-label="Remover ${produto.nome} do carrinho" data-id="${id}">X</button>
      `;

      itensCarrinhoContainer.appendChild(itemDiv);
    });

    totalCarrinho.textContent = `Total: ${formatarPreco(somaTotal)}`;
    formPedido.style.display = 'flex';
  }

  // Exibe/oculta carrinho
  function toggleCarrinho() {
    const aberto = carrinhoContainer.style.display === 'flex';
    if (aberto) {
      carrinhoContainer.style.display = 'none';
      carrinhoContainer.setAttribute('aria-hidden', 'true');
    } else {
      carrinhoContainer.style.display = 'flex';
      carrinhoContainer.setAttribute('aria-hidden', 'false');
      itensCarrinhoContainer.focus();
    }
  }

  // Limpa o carrinho
  function limparCarrinho() {
    if (confirm('Deseja realmente limpar o carrinho?')) {
      carrinho = {};
      salvarCarrinho();
      atualizarCarrinho();
      atualizarBadgeCarrinho();
      formPedido.style.display = 'none';
    }
  }

  // Evento para + e - e remover no carrinho
  itensCarrinhoContainer.addEventListener('click', (e) => {
    const target = e.target;
    const id = target.dataset.id;
    if (!id) return;

    if (target.dataset.action === 'aumentar') {
      alterarQuantidadeCarrinho(id, carrinho[id] + 1);
    } else if (target.dataset.action === 'diminuir') {
      alterarQuantidadeCarrinho(id, carrinho[id] - 1);
    } else if (target.classList.contains('item-remover')) {
      removerDoCarrinho(id);
    }
  });

  // Evento abrir/fechar carrinho
  botaoCarrinho.addEventListener('click', toggleCarrinho);
  fecharCarrinhoBtn.addEventListener('click', toggleCarrinho);

  // Evento limpar carrinho
  limparCarrinhoBtn.addEventListener('click', limparCarrinho);

  // Evento busca
  buscaInput.addEventListener('input', () => {
    const categoriaAtiva = categoriasContainer.querySelector('button.active');
    let cat = '';
    if (categoriaAtiva && categoriaAtiva.textContent !== 'Todas') {
      cat = categoriaAtiva.textContent;
    }
    filtrarProdutos(cat);
  });

  // Evento filtro categoria inicia com todas
  mostrarCategorias();
  mostrarProdutos(produtos);

  // Carregar carrinho salvo
  carregarCarrinho();
  atualizarCarrinho();
  atualizarBadgeCarrinho();

  // Mostrar ou esconder campo troco conforme pagamento
  pagamentoSelect.addEventListener('change', () => {
    if (pagamentoSelect.value === 'dinheiro') {
      trocoContainer.style.display = 'block';
      trocoInput.setAttribute('required', 'required');
    } else {
      trocoContainer.style.display = 'none';
      trocoInput.removeAttribute('required');
      trocoInput.value = '';
    }
  });

  // Enviar pedido via WhatsApp
  formPedido.addEventListener('submit', e => {
    e.preventDefault();

    if (Object.keys(carrinho).length === 0) {
      alert('Carrinho vazio! Adicione produtos antes de enviar o pedido.');
      return;
    }

    const nome = document.getElementById('nome').value.trim();
    const telefone = document.getElementById('telefone').value.trim();
    const endereco = document.getElementById('endereco').value.trim();
    const pagamento = pagamentoSelect.value;
    const troco = trocoInput.value;

    if (!nome || !telefone || !endereco || !pagamento) {
      alert('Por favor, preencha todos os campos obrigat√≥rios.');
      return;
    }

    let mensagem = `*Pedido de Supermercado*\n\n*Cliente:* ${nome}\n*Telefone:* ${telefone}\n*Endere√ßo:* ${endereco}\n*Pagamento:* ${pagamento === 'dinheiro' ? 'Dinheiro' : pagamento === 'cartao' ? 'Cart√£o' : 'PIX'}\n`;
    if (pagamento === 'dinheiro' && troco) {
      mensagem += `*Troco para:* R$ ${parseFloat(troco).toFixed(2)}\n`;
    }
    mensagem += `\n*Itens:*\n`;

    let somaTotal = 0;
    for (const id in carrinho) {
      const produto = produtos.find(p => p.id == id);
      const qtd = carrinho[id];
      const subtotal = produto.preco * qtd;
      somaTotal += subtotal;
      mensagem += `- ${produto.nome} x${qtd} = R$ ${subtotal.toFixed(2)}\n`;
    }
    mensagem += `\n*Total: R$ ${somaTotal.toFixed(2)}\n\nObrigado pela prefer√™ncia!`;

    // N√∫mero do WhatsApp para envio (coloque seu n√∫mero aqui, sem espa√ßos e com c√≥digo do pa√≠s)
    const numeroWhatsApp = '5584996220061'; // EXEMPLO: Brasil +55 11 99999-9999

    const urlWhatsApp = `https://wa.me/${numeroWhatsApp}?text=${encodeURIComponent(mensagem)}`;
    window.open(urlWhatsApp, '_blank');

    // Opcional: limpar carrinho e formul√°rio ap√≥s enviar
    carrinho = {};
    salvarCarrinho();
    atualizarCarrinho();
    atualizarBadgeCarrinho();
    formPedido.reset();
    trocoContainer.style.display = 'none';
  });
</script>
</body>
</html>
